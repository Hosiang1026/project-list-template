!function(){function e(){this.id=0,this.hasShortIntro=!0,this.hasGithub=!0,this.hasHome=!0,this.hasCode=!0,this.name="",this.content="",this.shortIntro="",this.tags=[],this.category="",this.home="",this.code="",this.github={star:"true",fork:"true",repo:""}}function t(e){e.stopPropagation(),e.preventDefault(),$("#upload").css("border-color","#3bafda")}function r(e){e.stopPropagation(),e.preventDefault(),$("#upload").css("border-color","#ddd")}function a(e){e.stopPropagation(),e.preventDefault(),$("#upload").css("border-color","#ddd"),null!=e.dataTransfer.files&&null!=e.dataTransfer.files[0]&&n(e.dataTransfer.files[0])}function o(e){e.stopPropagation(),e.preventDefault(),null!=this.files&&null!=this.files[0]&&n(this.files[0])}function n(e){var t,r,a;if(t=e,!l(t.name)){var o=$("[data-remodal-id=md-tip]").remodal();return void o.open()}$("#loader").css("display","block");var n=new FileReader;n.readAsText(t),r=d(t.name),n.onload=function(e){a=e.target.result,s(a)}}function s(t){t=t.replaceAll(u,c),t=t.replaceAll(f,p);var r=t.split(c),a=[],o=0;r.forEach(function(t){if(null!=t&&""==!t.trim()){var r=new e,n=t.split(p);1==n.length?r.hasShortIntro=!1:r.shortIntro=marked(n[0]),h={};var s=marked(t);console.log(s),$("#gen-html").html(s),$("pre").addClass("line-numbers"),Prism.highlightAll(),console.log($("#gen-html").html()),r.content=$("#gen-html").html(),h.hasOwnProperty("name")&&(r.name=h.name),h.hasOwnProperty("code")?r.code=h.code:r.hasCode=!1,h.hasOwnProperty("home")?r.home=h.home:r.hasHome=!1,h.hasOwnProperty("tags")&&(r.tags=h.tags),h.hasOwnProperty("category")&&(r.category=h.category);var i=r.github,l=h.github;h.hasOwnProperty("github")?(null!=l&&l.hasOwnProperty("repo")||(r.hasGithub=!1,r.star=!1,r.star=!1),l.hasOwnProperty("repo")&&(i.repo=l.repo),l.hasOwnProperty("star")&&!l.star&&(i.star=!1),l.hasOwnProperty("fork")&&!l.fork&&(i.fork=!1)):(r.hasGithub=!1,i.star=!1,i.fork=!1),r.id=o++,a.push(r)}}),w.getSession().setValue(JSON.stringify(a,null,4))}function i(){var e="data.json",t=w.getSession().getValue();if(null==t||""==t.trim())return void swal("数据不能为空","","error");var r=new Blob([t],{type:"application/json"});saveAs(r,e)}function l(e){var t=/(\.md|\.markdown|\.txt|\.mkd|\.text)$/i;return!!t.test(e)}function d(e){return e.substr(0,e.lastIndexOf("."))||e}var h,c="<!-- start -->",u=/<!--\s*start\s*-->/,p="<!-- more -->",f=/<!--\s*more\s*-->/,g="config",m=new marked.Renderer;m.code=function(e,t){switch(t){case g:return h=JSON.parse(e),"";default:return"<pre><code class='language-"+t+"'>"+e+"</code></pre>"}},marked.setOptions({renderer:m}),$("#download").click(i);var v=document.getElementById("select-file");v.addEventListener("dragenter",t,!1),v.addEventListener("dragleave",r,!1),v.addEventListener("drop",a,!1),v.addEventListener("change",o,!1);var w=ace.edit("editor");w.getSession().setMode("ace/mode/json"),w.setFontSize(14),w.setOption("wrap","free"),ace.require("ace/ext/language_tools"),w.container.style.lineHeight=1.5,w.renderer.updateFontSize(),String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"gm"),t)}}();